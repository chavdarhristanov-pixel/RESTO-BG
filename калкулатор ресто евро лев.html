<!DOCTYPE html>
<html lang="bg">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>РЕСТО КАЛКУЛАТОР</title>
<style>
body { margin:0; background:#2b2b2b; font-family:Arial,sans-serif; display:flex; justify-content:center; }
.app { max-width:400px; width:95vw; margin:2vh auto; }
.calc { background:#111; border-radius:20px; padding:12px; box-shadow:0 12px 30px rgba(0,0,0,0.7); }

h1 { color:#fff; text-align:center; margin:0; font-size:28px; }
.subtitle { text-align:center; font-size:12px; margin-top:2px; margin-bottom:10px; color:#aaa; }
.author { color:#2196f3; font-weight:bold; }
.union { color:#fff; font-weight:800; letter-spacing:1px; }

label { color:#aaa; font-size:12px; display:block; margin-bottom:2px; }
input { width:100%; padding:8px; margin-bottom:10px; font-size:20px; border-radius:8px; border:none; text-align:right; background:#eaeaea; box-sizing:border-box; }

button.currency { width:100%; padding:10px; font-size:18px; border-radius:18px; border:none; margin-bottom:10px; color:#fff; cursor:pointer; box-shadow:0 5px 12px rgba(0,0,0,0.7); transition:0.1s; }
button.currency:active { box-shadow: inset 0 3px 8px rgba(0,0,0,0.5); transform:translateY(1px); }
.btn-eur { background:#1e88e5; }
.btn-bgn { background:#43a047; }

.result { padding:8px; border-radius:8px; font-size:18px; font-weight:bold; text-align:right; margin-bottom:4px; box-shadow: inset 0 0 6px rgba(0,0,0,0.7); }
.gray  { background:#555; color:#eee; }
.blue  { background:#1565c0; color:#fff; }
.green { background:#2e7d32; color:#fff; }
.red   { background:#b71c1c; color:#fff; }
.or { text-align:center; color:#fff; font-weight:bold; margin:2px 0; letter-spacing:2px; }

.keypad { display:grid; grid-template-columns: repeat(4,1fr); gap:4px; margin-top:8px; }
.keypad button { width:100%; padding:12px; font-size:18px; border-radius:10px; border:none; background:#333; color:#fff; box-shadow:0 3px 8px rgba(0,0,0,0.5); }
.keypad .comma { grid-column:span 2; font-size:20px; background:#444; }
.keypad .del { grid-column:span 2; background:#8e2424; }
.keypad .clear { grid-column:span 2; background:#555; }

@media(max-width:360px){
  h1 { font-size:24px; }
  input { font-size:18px; padding:6px; }
  button.currency { font-size:16px; padding:6px; }
  .result { font-size:16px; padding:6px; }
  .keypad button { font-size:16px; padding:6px; }
  .keypad .comma { font-size:18px; }
}
</style>
</head>
<body>
<div class="app">
  <div class="calc">
    <h1>РЕСТО КАЛКУЛАТОР</h1>
    <div class="subtitle">
      Създадено от <span class="author">Чавдар Христанов</span> – <span class="union">ЕДИНЕНИЕ</span>
    </div>

    <label>Сметка (EUR)</label>
    <input id="bill" readonly placeholder="0,00" onclick="setActive(this)">

    <label>Платено</label>
    <input id="paid" readonly placeholder="0,00" onclick="setActive(this)">

    <button id="currencyBtn" class="currency btn-eur" onclick="toggleCurrency()">Платено в: EUR</button>

    <div id="restoEUR" class="result gray">Ресто EUR: 0,00</div>
    <div class="or">ИЛИ</div>
    <div id="restoBGN" class="result gray">Ресто BGN: 0,00</div>

    <!-- Клавиатура 4 реда -->
    <div class="keypad">
      <!-- Ред 1 -->
      <button onclick="pressKey('9')">9</button>
      <button onclick="pressKey('8')">8</button>
      <button onclick="pressKey('7')">7</button>
      <button onclick="pressKey('6')">6</button>

      <!-- Ред 2 -->
      <button onclick="pressKey('5')">5</button>
      <button onclick="pressKey('4')">4</button>
      <button onclick="pressKey('3')">3</button>
      <button onclick="pressKey('2')">2</button>

      <!-- Ред 3 -->
      <button onclick="pressKey('1')">1</button>
      <button onclick="pressKey('0')">0</button>
      <button class="comma" onclick="pressKey(',')">,</button>

      <!-- Ред 4 -->
      <button class="del" onclick="backspace()">⌫</button>
      <button class="clear" onclick="clearField()">C</button>
    </div>
  </div>
</div>

<!-- Звуци -->
<audio id="clickSound" preload="auto"><source src="data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEAESsAACJWAAACABAAZGF0YQgAAAAA" type="audio/wav"></audio>
<audio id="switchSound" preload="auto"><source src="data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEAESsAACJWAAACABAAZGF0YQgAAAAA" type="audio/wav"></audio>
<audio id="goodSound" preload="auto"><source src="data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEAESsAACJWAAACABAAZGF0YQgAAAAA" type="audio/wav"></audio>
<audio id="badSound" preload="auto"><source src="data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEAESsAACJWAAACABAAZGF0YQgAAAAA" type="audio/wav"></audio>

<script>
const RATE=1.95583; let paidCurrency="EUR"; let activeInput=null;
const bill=document.getElementById("bill");
const paid=document.getElementById("paid");
const restoEURBox=document.getElementById("restoEUR");
const restoBGNBox=document.getElementById("restoBGN");
const clickSound=document.getElementById("clickSound");
const switchSound=document.getElementById("switchSound");
const goodSound=document.getElementById("goodSound");
const badSound=document.getElementById("badSound");

function setActive(el){ activeInput=el; }
function playClick(){ try{ clickSound.currentTime=0; clickSound.play(); } catch(e){} }
function playSwitch(){ try{ switchSound.currentTime=0; switchSound.play(); } catch(e){} }
function playResto(isGood){ try{ (isGood?goodSound:badSound).currentTime=0; (isGood?goodSound:badSound).play(); } catch(e){} }

function parseBG(v){ return parseFloat(v.replace(",", "."))||0; }
function formatBG(v){ return v.toFixed(2).replace(".", ","); }

function toggleCurrency(){
  playSwitch();
  paidCurrency=paidCurrency==="EUR"?"BGN":"EUR";
  const btn=document.getElementById("currencyBtn");
  btn.className="currency "+(paidCurrency==="EUR"?"btn-eur":"btn-bgn");
  btn.textContent="Платено в: "+paidCurrency;
  calculate();
}

function calculate(){
  const billEUR=parseBG(bill.value);
  const paidVal=parseBG(paid.value);
  const paidEUR=paidCurrency==="BGN"?paidVal/RATE:paidVal;
  const restoEUR=paidEUR-billEUR;
  const restoBGN=restoEUR*RATE;

  restoEURBox.textContent=`Ресто EUR: ${formatBG(restoEUR)}`;
  restoBGNBox.textContent=`Ресто BGN: ${formatBG(restoBGN)}`;

  if(restoEUR<0){ 
    restoEURBox.className="result red"; restoBGNBox.className="result red"; playResto(false);
  } else if(restoEUR===0){ 
    restoEURBox.className="result gray"; restoBGNBox.className="result gray"; playResto(true);
  } else{ 
    restoEURBox.className="result blue"; restoBGNBox.className="result green"; playResto(true);
  }
}

function pressKey(key){
  if(!activeInput) return;
  playClick();
  let v=activeInput.value;
  if(key===',' && v.includes(',')) return;
  if(v.includes(',')){ const decimals=v.split(',')[1]; if(decimals.length>=2) return; }
  activeInput.value=v==="0,00"?key:v+key;
  calculate();
}
function backspace(){ if(!activeInput) return; playClick(); activeInput.value=activeInput.value.slice(0,-1); calculate(); }
function clearField(){ if(!activeInput) return; playClick(); activeInput.value=""; calculate(); }

window.addEventListener("load",()=>{ bill.focus(); activeInput=bill; });
</script>
</body>
</html>
